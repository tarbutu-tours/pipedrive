# חיבור וואטסאפ – איפה רואים אם הצליח ולמה נכשל

## איפה לראות אם החיבור מסתדר

1. **בטרמינל (איפה שהרצתם `npm start`)**  
   - אם הצליח: יופיע שורה **`[WhatsApp] ✅ חיבור הצליח – הבוט פעיל.`**  
   - אם נכשל: יופיע **`[WhatsApp] ❌ חיבור נכשל:`** ואחריו סיבה.

2. **בדפדפן (במשרד או אצלכם)**  
   פתחו את הדף:  
   **http://כתובת-המחשב:3000/whatsapp-status**  
   (אם השרת רץ על מחשב אחר – החלפו את "כתובת-המחשב" ב-IP או בשם המחשב).  
   - **חיבור פעיל** = ירוק, הבוט מחובר.  
   - **חיבור נכשל** / **נותק** = אדום, יש בעיה.

3. **קובץ סטטוס**  
   השרת כותב ל-`public/whatsapp-status.json` – אפשר לפתוח ולראות `status` ו-`message`.

---

## למה בטלפון כתוב "חיבור נכשל"

סיבות נפוצות:

| סיבה | מה לעשות |
|------|----------|
| **הברקוד פג תוקף** | הברקוד תקף כ־20–60 שניות. סורקים **מיד** אחרי שה־QR מופיע. אם עבר זמן – להריץ `npm run whatsapp:reset` ואז `npm start` ולסרוק ברקוד חדש. |
| **השרת לא רץ באותו רגע** | השרת חייב לרוץ **במחשב** כשסורקים. אם שלחתם רק קובץ וורד בלי שהשרת רץ – החיבור ייכשל. במשרד: להריץ `npm start` **ואז** לפתוח את קובץ הוורד ולסרוק. |
| **חומת אש / Proxy** | אם יש Proxy או חומת אש חזקה, לפעמים היא חוסמת את החיבור ל־web.whatsapp.com. לנסות מרשת אחרת או לבדוק הגדרות רשת. |
| **גרסת Chrome / Puppeteer** | לעדכן חבילות: `npm update whatsapp-web.js` ואז `npm run whatsapp:reset` ו־`npm start`. |
| **מטמון ישן** | להריץ `npm run whatsapp:reset` (מוחק גם `.wwebjs_cache`) ואז `npm start` ולסרוק שוב. |

---

## סדר פעולות מומלץ במשרד

1. במחשב שמריצים את הפרויקט: לפתוח טרמינל ב־WEBTARBUTU.
2. להריץ: `npm start`.
3. להמתין עד שמופיע QR (בטרמינל ו/או קובץ וורד מתעדכן).
4. **רק אז** לפתוח את `whatsapp-qr-document.docx` ולסרוק עם הטלפון **בתוך דקה**.
5. לבדוק בטרמינל שורה: `[WhatsApp] ✅ חיבור הצליח`.
6. לפתוח בדפדפן: `http://localhost:3000/whatsapp-status` – אמור להופיע "חיבור פעיל".

---

## אם עדיין נכשל

- להעתיק מהטרמינל את השורה שמתחילה ב־`[WhatsApp] ❌` (כולל הטקסט אחריה) ולשלוח למי שמטפל בשרת.
- לבדוק ש־Node.js מעודכן: `node -v` (מומלץ 18 ומעלה).
