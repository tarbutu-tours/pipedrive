# Competitor Research – שייט מאורגן (תרבותו vs מתחרים)

גריפה והשוואה של **מנו ספנות**, **קרוזתור** (בשביל הזהב) ו-**מסעות**.  
הפקת דוח אקסל לפי יעד (יפן, פיורדים, דנובה, ים תיכון וכו') עם קישורים לאתרי מתחרים.

## הרצה בלחיצת כפתור (בלי לבקש אישורים)

- **דאבל-קליק:** הרץ `run_scan.bat` – מריץ סריקה, עדכון נתונים ויצירת האקסל.  
  (אין צורך באישורים – ההרצה מהמחשב שלך.)

- **דשבורד בדפדפן:**  
  ```bash
  cd c:\Users\user\Documents\WORK
  node competitor_research/server.cjs
  ```  
  פתח בדפדפן: **http://localhost:3747** ולחץ **"הרץ סריקה עכשיו"**.  
  גם כאן ההרצה מקומית – Cursor לא מבקש אישור.

## למה Cursor מבקש אישור?

כשאתה מבקש **ממני** להריץ פקודות (טרמינל דרך Cursor), הסביבה דורשת אישור כי הפקודה רצה ב" sandbox ".  
כשאתה מריץ **בעצמך** – דאבל-קליק על `run_scan.bat` או `node competitor_research/server.cjs` בטרמינל – אין אישורים.

## קבצים עיקריים

| קובץ | תיאור |
|------|--------|
| `targets.json` | רשימת אתרים (תרבותו, מנו, קרוזתור, קשרי תעופה, גולדן טורס, **מסעות**) |
| `scraper.py` | גריפה (מנו, קרוזתור, מסעות) – Playwright |
| `run_full_scan.cjs` | צינור מלא: סריקה → enrich → אקסל |
| `enrich_competitors.cjs` | עדכון נתוני מתחרים + קישורים |
| `create_xlsx_sheetjs.cjs` | בניית `השוואת_טיולים_לפי_יעד.xlsx` (RTL, מסגרות, קישורים) |
| `server.cjs` + `dashboard.html` | דשבורד עם כפתור "הרץ סריקה" |
| `send_report_email.cjs` | סריקה + שליחת דוח במייל |
| `תזמון_דוח_כל_3_ימים.md` | הנחיות לשליחת דוח כל 3 ימים למייל |

## דוח כל 3 ימים למייל

1. הגדר `config.json` (העתק מ-`config.example.json`): `email.to`, `email.smtp_user`, `email.smtp_password`.
2. התקן: `npm install nodemailer` (משורש הפרויקט).
3. תזמן משימה ב-Windows (תכנון משימות): הרץ כל 3 ימים את  
   `node competitor_research\send_report_email.cjs`  
   מתיקייה `c:\Users\user\Documents\WORK`.  
   פרטים ב-**`תזמון_דוח_כל_3_ימים.md`**.

## אקסל

- **עמודת קישור:** בשורת מתחרים יש עמודה "קישור" – תא עם מחיר/קישור מכיל קישור לאתר החברה.
- **כיוון:** גיליונות מוגדרים כ-RTL (מימין לשמאל).
- **מסגרות ויישור:** מוגדרים במבנה הקובץ; אם החבילה הסטנדרטית לא שומרת עיצוב, אפשר לעדכן ידנית ב-Excel או להשתמש ב-`xlsx-js-style`.

## הרצה ידנית (משורש הפרויקט)

```bash
cd c:\Users\user\Documents\WORK
node competitor_research/run_full_scan.cjs
```

לאחר ההרצה: `competitor_research/השוואת_טיולים_לפי_יעד.xlsx`.
